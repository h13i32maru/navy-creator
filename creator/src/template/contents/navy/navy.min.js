(function(){"use strict";window.Navy={};window.addEventListener("DOMContentLoaded",function(){if(Navy.UnitTest){return}Navy.App.initialize()});Navy.Class=function(t){var e;var i;var n;switch(arguments.length){case 2:n=Navy.Class._RootClass;e=arguments[0];i=arguments[1];break;case 3:if(typeof arguments[1]==="function"){n=arguments[1]}else{n=arguments[1].constructor}e=arguments[0];i=arguments[2];break;default:throw new Error("arguments of Navy.Class is 2 or 3.")}var a=Navy.Class._create(e,n,i);Navy.Class._setByReflection(e,a);return a};Navy.Class.instance=function t(e){var i=Navy.Class.apply(Navy,arguments);i.__manualInitialize__=true;var n=new i;var a=arguments[0];Navy.Class._setByReflection(a,n);return n};Navy.Class._RootClass=function e(){};Navy.Class._RootClass.prototype.initialize=function(){};Navy.Class._getByReflection=function i(t){var e=t.split(".");var i=window;for(var n=0;n<e.length;n++){i=i[e[n]]}return i};Navy.Class._setByReflection=function n(t,e){var i=t.split(".");var n=window;for(var a=0;a<i.length-1;a++){if(!(i[a]in n)){n[i[a]]={}}n=n[i[a]]}n[i[a]]=e};Navy.Class._create=function a(t,e,i){var n=t.replace(/[.]/g,"$");var a=new Function("return function "+n+" () { if (typeof this.initialize === 'function' && !this.constructor.__manualInitialize__) { this.initialize.apply(this, arguments); } }")();function s(){}s.prototype=e.prototype;var r=new s;var o=new s;a.prototype=r;var l;var h;if(i.$static){for(l in i.$static){var h=i.$static[l];if(typeof h==="function"){if(Navy.Class._argumentNames(h)[0]==="$super"){h=Navy.Class._wrapFunction(e,l,h)}}a[l]=h}delete i.$static}for(l in i){h=i[l];if(typeof h==="object"&&h!==null){if(l!=="$static"){throw new Error("object property must be primitive type. property = "+l)}}if(typeof h==="function"){if(Navy.Class._argumentNames(h)[0]==="$super"){h=Navy.Class._wrapFunction(o,l,h)}}a.prototype[l]=h}a.prototype.constructor=a;a.prototype.$className=t;a.prototype.$class=a;return a};Navy.Class._argumentNames=function s(t){var e=t.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return e.length==1&&!e[0]?[]:e};Navy.Class._wrapFunction=function r(t,e,i){if(typeof t[e]!=="function"){throw new Error("override method must be function. function = "+e)}return function(){var n=this;var $super=function(){return t[e].apply(n,arguments)};var a=[$super].concat(Array.prototype.slice.call(arguments,0));return i.apply(this,a)}};Navy.Class("Navy.Notify",{_count:null,_callback:null,initialize:function(t,e){if(arguments.length===2){this.set(t,e)}},pass:function(){this._count--;if(this._count===0){this._execCallback()}},set:function(t,e){this._count=t;this._callback=e;if(t===0){this._execCallback()}},_execCallback:function(){setTimeout(this._callback,0)}});Navy.Class.instance("Navy.App",{_initRootBeforeCallback:null,initialize:function(){Navy.Resource.initialize();Navy.Config.initialize(this._onInitConfig.bind(this))},setInitRootBeforeCallback:function(t){this._initRootBeforeCallback=t},_onInitConfig:function(){this._initRootBeforeCallback&&this._initRootBeforeCallback();Navy.Root.initialize()}});Navy.Class.instance("Navy.Config",{app:null,scene:null,page:null,initialize:function(t){var e=new Navy.Notify(3,t);var i=e.pass.bind(e);this._loadAppJSON(i);this._loadSceneJSON(i);this._loadPageJSON(i)},_loadAppJSON:function(t){var e=new XMLHttpRequest;e.open("GET","config/app.json");e.onload=function(e){var i=e.target;this.app=JSON.parse(i.responseText);t()}.bind(this);e.send()},_loadSceneJSON:function(t){var e=new XMLHttpRequest;e.open("GET","config/scene.json");e.onload=function(e){var i=e.target;var n=JSON.parse(i.responseText);var a={};for(var s=0;s<n.length;s++){a[n[s].id]=n[s]}this.scene=a;t()}.bind(this);e.send()},_loadPageJSON:function(t){var e=new XMLHttpRequest;e.open("GET","config/page.json");e.onload=function(e){var i=e.target;var n=JSON.parse(i.responseText);var a={};for(var s=0;s<n.length;s++){a[n[s].id]=n[s]}this.page=a;t()}.bind(this);e.send()}});Navy.Class.instance("Navy.Resource",{_layouts:null,_scripts:null,_images:null,_loadingLayouts:null,initialize:function(){this._layouts={};this._scripts={};this._images={};this._loadingLayouts={}},loadLayout:function(t,e){if(this._layouts[t]){var i=this._layouts[t];var n=JSON.parse(i);e&&setTimeout(e.bind(null,n),0);return}if(this._loadingLayouts[t]){this._loadingLayouts[t].push(e);return}this._loadingLayouts[t]=[e];var a=new XMLHttpRequest;a.open("GET",t);a.onload=function(e){var i=e.target;var n=i.responseText;this._layouts[t]=n;var a=this._loadingLayouts[t];this._loadingLayouts[t]=null;for(var s=0;s<a.length;s++){var r=JSON.parse(n);a[s](r)}}.bind(this);a.send()},loadScript:function(t,e){if(this._scripts[t]){e&&setTimeout(e,0);return}var i=document.createElement("script");i.onload=function(){this._scripts[t]=true;e()}.bind(this);i.src=t;document.head.appendChild(i)},loadImage:function(t,e){if(this._images[t]){var i=this._images[t].width;var n=this._images[t].height;e&&setTimeout(e.bind(null,t,i,n),0);return}var a=new Image;a.onload=function(){this._images[t]={width:a.width,height:a.height};e(t,a.width,a.height)}.bind(this);a.src=t},getClass:function(t){var e=t.split(".");var i=window;for(var n=0;n<e.length;n++){i=i[e[n]]}return i}});Navy.Class("Navy.View.View",{SIZE_POLICY_FIXED:"fixed",SIZE_POLICY_WRAP_CONTENT:"wrapContent",SIZE_POLICY_MATCH_PARENT:"matchParent",_id:null,_page:null,_scene:null,_layout:null,_element:null,_parentView:null,_eventCallbackMap:null,_eventCallbackId:0,_linkGesture:null,initialize:function(t,e){this._eventCallbackMap={};this._preventDOMEvent=this._preventDOMEvent.bind(this);if(t){this._id=t.id}this._layout=t;this._createElement(t);this._createExtraElement(t);this.setLayout(t,e)},setLayout:function(t,e){if(!t){return}function i(){var e=new Navy.Notify(2,n.bind(this));var i=e.pass.bind(e);this._applyLayout(t,i);this._applyExtraLayout(t,i)}function n(){this._updateSizeWithWrapContentSize();e&&e(this)}this._layout=t;var a=new Navy.Notify(2,i.bind(this));var s=a.pass.bind(a);this._loadResource(t,s);this._loadExtraResource(t,s)},getLayout:function(){return this._cloneObject(this._layout)},lockView:function(){this._element.addEventListener("touchstart",this._preventDOMEvent,true)},unlockView:function(){this._element.removeEventListener("touchstart",this._preventDOMEvent,true)},_preventDOMEvent:function(t){t.stopPropagation();t.preventDefault()},_createElement:function(t){this._element=document.createElement("div");this._element.style.visibility="hidden";this._linkGesture=new Navy.Gesture.Tap(this._element,this._onLink.bind(this))},_applyLayout:function(t,e){this._element.style.position="absolute";this.setVisible(t.visible);this.setPos(t.pos);this.setSizePolicy(t.sizePolicy,true);this.setSize(t.size);this.setBackgroundColor(t.backgroundColor);this.setLink(t.link);this._setRawStyle({overflow:"hidden"});e&&setTimeout(e,0)},_loadResource:function(t,e){e&&setTimeout(e,0)},_createExtraElement:function(t){},_applyExtraLayout:function(t,e){e&&setTimeout(e,0)},_loadExtraResource:function(t,e){e&&setTimeout(e,0)},_calcWrapContentSize:function(){return{width:0,height:0}},_updateSizeWithWrapContentSize:function(){var t=false;var e;if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT||this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){e=this._calcWrapContentSize()}if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT){this._element.style.width=e.width+"px";t=true}if(this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._element.style.height=e.height+"px";t=true}if(t){this.trigger("sizeChanged",this,null)}},_setRawStyle:function(t){var e="";for(var i in t){var n=t[i];if(n!==undefined){var a=i.replace(/([A-Z])/g,"-$1").toLowerCase();if(a.indexOf("webkit")===0){a="-"+a}if(n===""){this._element.style[i]=""}else{e+=a+":"+n+";"}}}this._element.style.cssText+=e},_onLink:function(t){this.trigger("link",this,t);var e=this._layout.link.id.split("/");var i=e[0];var n=e[1];switch(i){case"page":this.getScene().linkPage(n);break;case"scene":Navy.Root.linkScene(n);break}},on:function(t,e){if(!this._eventCallbackMap[t]){this._eventCallbackMap[t]=[]}var i=this._eventCallbackId++;this._eventCallbackMap[t].push({callbackId:i,callback:e});return i},off:function(t,e){var i=this._eventCallbackMap[t];if(!i){return}if(typeof e==="function"){var n=e;for(var a=0;a<i.length;a++){if(n===i[a].callback){i.splice(a,1);a--}}}else{var s=e;for(var a=0;a<i.length;a++){if(s===i[a].callbackId){i.splice(a,1);return}}}},trigger:function(t,e,i){var n=this._eventCallbackMap[t];if(!n){return}for(var a=0;a<n.length;a++){var s=n[a].callback;s(e,i)}},addRawEventListener:function(t,e){this._element.addEventListener(t,e)},removeRawEventListener:function(t,e){this._element.removeEventListener(t,e)},getId:function(){return this._id},setPage:function(t){this._page=t},getPage:function(){return this._page},setScene:function(t){this._scene=t},getScene:function(){return this._scene},getElement:function(){return this._element},setParent:function(t){this._parentView=t},getParent:function(){return this._parentView},destroy:function(){this._parentView.removeView(this);var t=Object.getOwnPropertyNames(this);for(var e=0;e<t.length;e++){this[t[e]]=null}},toJSON:function(){return this._layout},_cloneObject:function(t){return JSON.parse(JSON.stringify(t))},isVisible:function(){if(!this._layout.visible){return false}for(var t=this.getParent();t;t=t.getParent()){if(!t.isVisible()){return false}}return true},setVisible:function(t){this._layout.visible=t;if(t){this._element.style.visibility=""}else{this._element.style.visibility="hidden"}},setBackgroundColor:function(t){this._layout.backgroundColor=t;this._element.style.backgroundColor=t},getBackgroundColor:function(){return this._layout.backgroundColor},setSizePolicy:function(t,e){this._layout.sizePolicy=t;switch(t.width){case this.SIZE_POLICY_FIXED:break;case this.SIZE_POLICY_WRAP_CONTENT:if(!e){this._updateSizeWithWrapContentSize()}break;case this.SIZE_POLICY_MATCH_PARENT:this._element.style.width="100%";break;default:throw new Error("unknown size policy width. "+this._layout.sizePolicy.width)}switch(t.height){case this.SIZE_POLICY_FIXED:break;case this.SIZE_POLICY_WRAP_CONTENT:if(!e){this._updateSizeWithWrapContentSize()}break;case this.SIZE_POLICY_MATCH_PARENT:this._element.style.height="100%";break;default:throw new Error("unknown size policy height. "+this._layout.sizePolicy.height)}},getSizePolicy:function(){return this._cloneObject(this._layout.sizePolicy)},getSize:function(){var t,e;switch(this._layout.sizePolicy.width){case this.SIZE_POLICY_FIXED:t=this._layout.size.width;break;case this.SIZE_POLICY_WRAP_CONTENT:t=this._element.clientWidth;break;case this.SIZE_POLICY_MATCH_PARENT:t=this._element.clientWidth;break;default:throw new Error("unknown size policy width. "+this._layout.sizePolicy.width)}switch(this._layout.sizePolicy.height){case this.SIZE_POLICY_FIXED:e=this._layout.size.height;break;case this.SIZE_POLICY_WRAP_CONTENT:e=this._element.clientHeight;break;case this.SIZE_POLICY_MATCH_PARENT:e=this._element.clientHeight;break;default:throw new Error("unknown size policy height. "+this._layout.sizePolicy.height)}return{width:t,height:e}},setSize:function(t){if(!t){return}if(!this._layout.size){this._layout.size={}}if(this._layout.sizePolicy.width===this.SIZE_POLICY_FIXED){if(typeof t.width==="number"){this._layout.size.width=t.width;this._element.style.width=t.width+"px"}}if(this._layout.sizePolicy.height===this.SIZE_POLICY_FIXED){if(typeof t.height==="number"){this._layout.size.height=t.height;this._element.style.height=t.height+"px"}}this.trigger("sizeChanged",this,null)},setPos:function(t){var e="";if(typeof t.x==="number"){var i=parseInt(t.x,10);this._layout.pos.x=i;e+="left:"+i+"px;"}if(typeof t.y==="number"){var n=parseInt(t.y,10);this._layout.pos.y=n;e+="top:"+n+"px;"}if(typeof t.z==="number"){var a=parseInt(t.z,10);this._layout.pos.z=a;e+="z-index:"+a+";"}this._element.style.cssText+=e;this.trigger("posChanged",this,null)},addPos:function(t){var e=this._layout.pos.x+(t.x||0);var i=this._layout.pos.y+(t.y||0);this.setPos({x:e,y:i})},getPos:function(){return this._cloneObject(this._layout.pos)},setLink:function(t){this._layout.link=t;if(t){this._linkGesture.start()}else{this._linkGesture.stop()}},getLink:function(){return this._cloneObject(this._layout.link)}});Navy.Class("Navy.View.Image",Navy.View.View,{_imgElm:null,initialize:function($super,t,e){$super(t,e)},_createExtraElement:function($super,t){$super(t);var e=document.createElement("img");this._element.appendChild(e);this._imgElm=e},_applyExtraLayout:function($super,t,e){$super(t,e)},_loadExtraResource:function($super,t,e){if(t&&t.extra.src){this.setSrc(t.extra.src,function(){$super(t,e)})}else{$super(t,e)}},_calcWrapContentSize:function(){return{width:this._imgElm.width,height:this._imgElm.height}},_onLoadImage:function(t,e,i){this._imgElm.src=t;this.trigger("sizeChanged",this,null)},setSrc:function(t,e){this._layout.extra.src=t;Navy.Resource.loadImage(t,function(t,i,n){this._onLoadImage(t,i,n);e&&e()}.bind(this))},getSrc:function(){return this._layout.src}});Navy.Class("Navy.View.Text",Navy.View.View,{_textElement:null,initialize:function($super,t,e){$super(t,e)},_createExtraElement:function($super,t){$super(t);this._textElement=document.createElement("span");this._textElement.style.display="inline-block";this._element.appendChild(this._textElement)},_applyExtraLayout:function($super,t,e){if(!t.extra){return}this.setFontSize(t.extra.fontSize);this.setFontColor(t.extra.fontColor);$super(t,e)},_loadExtraResource:function($super,t,e){this.setText(t.extra.text);$super(t,e)},_calcWrapContentSize:function(){return{width:this._textElement.offsetWidth,height:this._textElement.offsetHeight}},setText:function(t){this._layout.extra.text=t;this._textElement.textContent=t;if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT||this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._updateSizeWithWrapContentSize();this.trigger("sizeChanged",this,null)}},getText:function(){return this._layout.extra.text},setFontSize:function(t){this._layout.extra.fontSize=t;this._element.style.fontSize=t+"px";if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT||this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._updateSizeWithWrapContentSize();this.trigger("sizeChanged",this,null)}},getFontSize:function(){return this._layout.extra.fontSize},setFontColor:function(t){this._layout.extra.fontColor=t;this._element.style.color=t},getFontColor:function(){return this._layout.extra.fontColor}});Navy.Class("Navy.View.TextEdit",Navy.View.View,{_textElement:null,initialize:function($super,t,e){$super(t,e)},_createExtraElement:function($super,t){$super(t);this._textElement=document.createElement("input");this._textElement.style.cssText="width: 100%; height:100%; box-sizing:border-box; border:none;";this._element.appendChild(this._textElement)},_loadExtraResource:function($super,t,e){this.setText(t.extra.text);$super(t,e)},_calcWrapContentSize:function(){return{width:this._textElement.offsetWidth,height:this._textElement.offsetHeight}},_applyExtraLayout:function($super,t,e){if(!t.extra){return}this.setFontSize(t.extra.fontSize);this.setFontColor(t.extra.fontColor);this.setPlaceholder(t.extra.placeholder);$super(t,e)},setText:function(t){this._layout.extra.text=t;this._textElement.value=t;if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT||this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._updateSizeWithWrapContentSize();this.trigger("sizeChanged",this,null)}},getText:function(){return this._layout.extra.text},setFontSize:function(t){this._layout.extra.fontSize=t;this._textElement.style.fontSize=t+"px";if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT||this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._updateSizeWithWrapContentSize();this.trigger("sizeChanged",this,null)}},getFontSize:function(){return this._layout.extra.fontSize},setFontColor:function(t){this._layout.extra.fontColor=t;this._textElement.style.color=t},getFontColor:function(){return this._layout.extra.fontColor},getPlaceholder:function(){return this._layout.extra.placeHolder},setPlaceholder:function(t){this._textElement.placeholder=t;this._layout.extra.placeholder=t}});Navy.Class("Navy.ViewGroup.ViewGroup",Navy.View.View,{_views:null,_viewsOrder:null,_initCallback:null,_contentLayouts:null,_wrapContentSizeView:null,initialize:function($super,t,e){this._views={};this._viewsOrder=[];this._wrapContentSizeView={widthView:null,heightView:null};$super(t,e)},_loadExtraResource:function($super,t,e){if(t&&t.extra.contentLayoutFile){this._layout.extra.contentLayoutFile=t.extra.contentLayoutFile;Navy.Resource.loadLayout(t.extra.contentLayoutFile,function(i){this._contentLayouts=i;$super(t,e)}.bind(this))}else{this._layout&&(this._layout.extra.contentLayoutFile=null);$super(t,e)}},_applyExtraLayout:function($super,t,e){if(!this._contentLayouts){$super(t,e);return}var i=this._contentLayouts;var n=new Navy.Notify(i.length,function(){$super(t,e)});var a=n.pass.bind(n);for(var s=0;s<i.length;s++){var r=i[s];var o=Navy.Resource.getClass(r.class);var l=new o(r,a);this.addView(l)}},_onLoadContentLayout:function(t){var e=new Navy.Notify(t.length,this._initCallback);var i=e.pass.bind(e);for(var n=0;n<t.length;n++){var a=t[n];var s=Navy.Resource.getClass(a.class);var r=new s(a,i);this.addView(r)}},_resizeWrapContentByChangedView:function(t){if(this._layout.sizePolicy.width!==this.SIZE_POLICY_WRAP_CONTENT&&this._layout.sizePolicy.height!==this.SIZE_POLICY_WRAP_CONTENT){return}var e=t.getSizePolicy();var i,n,a;if(e.width!==this.SIZE_POLICY_MATCH_PARENT||e.height!==this.SIZE_POLICY_MATCH_PARENT){i=this.getSize();n=t.getPos();a=t.getSize()}if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT){if(e.width!==this.SIZE_POLICY_MATCH_PARENT){if(n.x+a.width>i.width){this._wrapContentSizeView.widthView=t;this._element.style.width=n.x+a.width+"px"}}}if(this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){if(e.height!==this.SIZE_POLICY_MATCH_PARENT){if(n.y+a.height>i.height){this._wrapContentSizeView.heightView=t;this._element.style.height=n.y+a.height+"px"}}}},_resizeWrapContentByRemovedView:function(t){if(this._layout.sizePolicy.width!==this.SIZE_POLICY_WRAP_CONTENT&&this._layout.sizePolicy.height!==this.SIZE_POLICY_WRAP_CONTENT){return}if(this._wrapContentSizeView.widthView!==t&&this._wrapContentSizeView.heightView!==t){return}var e=this._calcWrapContentSize();if(this._layout.sizePolicy.width===this.SIZE_POLICY_WRAP_CONTENT){this._element.style.width=e.width+"px"}if(this._layout.sizePolicy.height===this.SIZE_POLICY_WRAP_CONTENT){this._element.style.height=e.height+"px"}},_calcWrapContentSize:function(){var t=0;var e=0;var i;var n;var a=this._views;for(var s in a){var r=a[s];var o=r.getSizePolicy();if(o.width===this.SIZE_POLICY_MATCH_PARENT&&o.height===this.SIZE_POLICY_MATCH_PARENT){continue}var l=r.getPos();var h=r.getSize();if(o.width!==this.SIZE_POLICY_MATCH_PARENT){if(t<l.x+h.width){t=l.x+h.width;i=r}}if(o.height!==this.SIZE_POLICY_MATCH_PARENT){if(e<l.y+h.height){e=l.y+h.height;n=r}}}return{width:t,height:e}},destroy:function($super){for(var t in this._views){var e=this._views[t];e.destroy()}$super()},setPage:function($super,t){$super(t);var e=this._views;for(var i in e){var n=e[i];n.setPage(t)}},setScene:function($super,t){$super(t);var e=this._views;for(var i in e){var n=e[i];n.setScene(t)}},findViewById:function(t){var e=t.split(".");var i=this._views[e[0]]||null;if(i){if(e.length===1){return i}else{e.shift();return i.findViewById(e.join("."))}}var n=this._views;for(var a in n){var i=n[a];if(i.findViewById){var s=i.findViewById(t);if(s){return s}}}return null},findViewByElement:function(t){var e=this._views;for(var i in e){var n=e[i];if(n.getElement()===t){return n}if(n.findViewByElement){var a=n.findViewByElement(t);if(a){return a}}}return null},getAllViews:function(){var t={};for(var e in this._views){t[e]=this._views[e]}return t},addView:function(t,e){var i=t.getElement();if(e){this._element.insertBefore(i,e.getElement())}else{this._element.appendChild(i)}this._views[t.getId()]=t;this._viewsOrder.push(t.getId());t.setParent(this);t.setPage(this.getPage());t.setScene(this.getScene());t.on("sizeChanged",this._resizeWrapContentByChangedView.bind(this));t.on("posChanged",this._resizeWrapContentByChangedView.bind(this))},removeView:function(t){var e=t.getElement();this._element.removeChild(e);this._views[t.getId()]=null;delete this._views[t.getId()];this._viewsOrder.splice(this._viewsOrder.indexOf(t.getId()),1);t.setParent(null);this._resizeWrapContentByRemovedView(t)},removeAllViews:function(){var t=this._views;var e=Object.keys(t);for(var i=0;i<e.length;i++){var n=e[i];var a=t[n];this.removeView(a)}}});Navy.Class("Navy.ViewGroup.Button",Navy.ViewGroup.ViewGroup,{_imageView:null,_textView:null,initialize:function($super,t,e){$super(t,e)},_createExtraElement:function($super,t){$super(t);this._element.addEventListener("touchstart",this._onTouchStart.bind(this));this._element.addEventListener("touchend",this._onTouchEnd.bind(this))},_loadExtraResource:function($super,t,e){function i(){$super(t,e)}var n=new Navy.Notify(3,i);var a=n.pass.bind(n);if(t.extra.normal.src){Navy.Resource.loadImage(t.extra.normal.src,a)}else{a()}if(t.extra.active.src){Navy.Resource.loadImage(t.extra.active.src,a)}else{a()}if(t.extra.disabled.src){Navy.Resource.loadImage(t.extra.disabled.src,a)}else{a()}},_applyExtraLayout:function($super,t,e){function i(){var i=this._imageView.getSize();this._textView.setSizePolicy({width:this.SIZE_POLICY_FIXED,height:this.SIZE_POLICY_FIXED});this._textView.setSize(i);this._textView.getElement().style.lineHeight=i.height+"px";this._textView.getElement().style.textAlign="center";$super(t,e)}if(this._imageView){this.removeView(this._imageView)}if(this._textView){this.removeView(this._textView)}var n=new Navy.Notify(2,i.bind(this));var a=n.pass.bind(n);var s=this._cloneObject(t);s.id="image";s.pos={x:0,y:0};s.extra.src=t.extra.normal.src;this._imageView=new Navy.View.Image(s,a);this.addView(this._imageView);var r=this._cloneObject(t);r.id="text";r.pos={x:0,y:0};this._textView=new Navy.View.Text(r,a);this.addView(this._textView)},_onTouchStart:function(){if(!this._layout.extra.active.src){return}this._imageView.setSrc(this._layout.extra.active.src)},_onTouchEnd:function(){if(!this._layout.extra.normal.src){return}setTimeout(function(){this._imageView.setSrc(this._layout.extra.normal.src)}.bind(this),400)}});Navy.Class("Navy.ViewGroup.ListView",Navy.ViewGroup.ViewGroup,{initialize:function($super,t,e){$super(t,e)},_applyExtraLayout:function($super,t,e){$super(t,e);this._element.style.overflow="scroll";if(this._layout.extra.mock){var i=[];for(var n=0;n<30;n++){i.push({})}this.setItems(i)}},clear:function(){for(var t in this._views){var e=this._views[t];this.removeView(e)}},setItems:function(t,e){this.clear();this.insertItems(t,0,e)},addItems:function(t,e){this.insertItems(t,this._viewsOrder.length,e)},insertItems:function(t,e,i){if(e<0||e>this._viewsOrder.length){throw new Error("out of range. index = "+e)}if(e===this._viewsOrder.length){var n=null}else{var a=this._viewsOrder[e];var n=this.findViewById(a)}var s=new Navy.Notify(t.length,function(){var e=this._layout.extra.itemLayoutMargin+"px";for(var n=0;n<t.length;n++){var a=l[n];var s=t[n];var r=false;if(i){r=i(s,a,n,o+n)}if(r===false){for(var h in s){var _=a.findViewById(h);if(!_){continue}if(_.setText){_.setText(s[h])}else if(_.setSrc){_.setSrc(s[h])}}}a.getElement().style.position="relative";a.getElement().style.marginBottom=e;a.setVisible(true)}}.bind(this));var r=s.pass.bind(s);var o=this._viewsOrder.length;var l=[];for(var h=0;h<t.length;h++){var _={id:"item"+(o+h),visible:false,sizePolicy:{width:"wrapContent",height:"wrapContent"},pos:{x:0,y:0},extra:{contentLayoutFile:this._layout.extra.itemLayoutFile}};var u=new Navy.ViewGroup.ViewGroup(_,r);this.addView(u,n);l.push(u)}}});Navy.Class("Navy.Page",Navy.ViewGroup.ViewGroup,{initialize:function($super,t,e){$super(t,e)},setLayout:function($super,t,e){t.visible=true;t.pos={x:0,y:0};t.sizePolicy={width:this.SIZE_POLICY_FIXED,height:this.SIZE_POLICY_FIXED};t.size={width:Navy.Config.app.size.width,height:Navy.Config.app.size.height};$super(t,e)},setPage:function($super,t){},getPage:function(){return this},onCreate:function(){console.log("onCreate",this.$className);this.trigger("create",this,null)},onResumeBefore:function(){console.log("onResumeBefore",this.$className);this.trigger("resumeBefore",this,null)},onResumeAfter:function(){console.log("onResumeAfter",this.$className);this.trigger("resumeAfter",this,null)},onPauseBefore:function(){console.log("onPauseBefore",this.$className);this.trigger("pauseBefore",this,null)},onPauseAfter:function(){console.log("onPauseAfter",this.$className);this.trigger("pauseAfter",this,null)},onDestroy:function(){console.log("onDestroy",this.$className);this.trigger("destroy",this,null)}});Navy.Class.instance("Navy.Root",Navy.ViewGroup.ViewGroup,{_sceneStack:null,initialize:function($super){$super();this._id="$root";this._layout={visible:true,sizePolicy:{width:this.SIZE_POLICY_FIXED,height:this.SIZE_POLICY_FIXED},size:{width:Navy.Config.app.size.width,height:Navy.Config.app.size.height}};this._initDocument();var t=document.createElement("div");t.style.cssText="position:absolute; width:100%; height:100%; overflow:hidden;";document.body.appendChild(t);this._element=t;this._sceneStack=[];var e=Navy.Config.app.start.scene;this.nextScene(e)},getCurrentScene:function(){var t=this._getCurrentStack();return t.scene},getCurrentPage:function(){var t=this.getCurrentScene();return t.getCurrentPage()},linkScene:function(t){if(t==="$back"){this.backScene()}else{this.nextScene(t)}},nextScene:function(t){this.lockView();this._createScene(t,this._addScene.bind(this))},backScene:function(){if(this._sceneStack.length>=2){this.lockView();var t=this._getPrevStack();t.scene.onResumeBefore();var e=this._getCurrentStack();e.scene.onPauseBefore();e.transition.back(this._onTransitionBackEnd.bind(this))}},_initDocument:function(){var t="* {margin:0; padding:0; -webkit-user-select: none; -webkit-user-drag:none;} html {width:100%; height:100%} body {background-color:#000;}";var e=document.createElement("style");e.textContent=t;document.head.appendChild(e);var i=Navy.Config.app.size.width;var n=Navy.Config.app.size.height;var a=window.innerWidth;var s=window.innerHeight;var r=a/i;var o=s/n;var l=Math.min(r,o);var h=(a-l*i)/2;var _=(s-l*n)/2;document.body.style.position="absolute";document.body.style.zoom=l;document.body.style.width=i+"px";document.body.style.height=n+"px";document.body.style.left=h/l+"px";document.body.style.top=_/l+"px"},_createScene:function(t,e){var i=Navy.Config.scene[t];Navy.Resource.loadScript(i.classFile,this._onLoadScript.bind(this,i,e))},_onLoadScript:function(t,e){var i=Navy.Resource.getClass(t.class);var n=new i(t,e);this.addView(n)},_addScene:function(t){t.onCreate();t.onResumeBefore();var e=this._getCurrentStack();if(e){var i=e.scene;i.onPauseBefore()}var n=Navy.Resource.getClass(t.getLayout().extra.transition.class);var a=new n(i,t);this._sceneStack.push({scene:t,transition:a});a.start(this._onTransitionStartEnd.bind(this))},_removeCurrentScene:function(){var t=this._sceneStack.pop();t.scene.destroy()},_getCurrentStack:function(){if(this._sceneStack.length>=1){return this._sceneStack[this._sceneStack.length-1]}else{return null}},_getPrevStack:function(){if(this._sceneStack.length>=2){return this._sceneStack[this._sceneStack.length-2]}else{return null}},_onTransitionStartEnd:function(){var t=this._getPrevStack();if(t){t.scene.onPauseAfter()}var e=this._getCurrentStack();if(e){e.scene.onResumeAfter()}this.unlockView()},_onTransitionBackEnd:function(){var t=this._getPrevStack();if(t){t.scene.onResumeAfter()}var e=this._getCurrentStack();if(e){e.scene.onPauseAfter();e.scene.onDestroy();this._removeCurrentScene()}this.unlockView()}});Navy.Class("Navy.Scene",Navy.ViewGroup.ViewGroup,{LIFE_CYCLE_STATE_CREATE:1,LIFE_CYCLE_STATE_RESUME_BEFORE:2,LIFE_CYCLE_STATE_RESUME_AFTER:3,LIFE_CYCLE_STATE_PAUSE_BEFORE:4,LIFE_CYCLE_STATE_PAUSE_AFTER:5,LIFE_CYCLE_STATE_DESTROY:6,_lifeCycleState:0,_pageStack:null,_sceneFixedFirstView:null,initialize:function($super,t,e){this._pageStack=[];$super(t,function(){var i=this._viewsOrder[0];this._sceneFixedFirstView=this._views[i];this.nextPage(t.extra.page,e.bind(null,this))}.bind(this))},setLayout:function($super,t,e){t.visible=true;t.pos={x:0,y:0};t.sizePolicy={width:this.SIZE_POLICY_FIXED,height:this.SIZE_POLICY_FIXED};t.size={width:Navy.Config.app.size.width,height:Navy.Config.app.size.height};$super(t,e)},setPage:function(t){},getPage:function(){return null},setScene:function(t){},getScene:function(){return this},getCurrentPage:function(){var t=this._getCurrentStack();return t.page},linkPage:function(t){if(t==="$back"){this.backPage()}else{this.nextPage(t)}},nextPage:function(t,e){Navy.Root.lockView();this._createPage(t,function(t){this._addPage(t);e&&e(t)}.bind(this))},backPage:function(){if(this._pageStack.length>=2){Navy.Root.lockView();var t=this._getCurrentStack();var e=this._getPrevStack();t.page.onPauseBefore();e.page.onResumeBefore();var i=t.transition;i.back(this._onTransitionBackEnd.bind(this))}},onCreate:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_CREATE;console.log("onCreate",this.$className);this.trigger("create",this,null);var t=this.getCurrentPage();t.onCreate()},onResumeBefore:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_PAUSE_BEFORE;console.log("onResumeBefore",this.$className);this.trigger("resumeBefore",this,null);var t=this.getCurrentPage();t.onResumeBefore()},onResumeAfter:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_PAUSE_AFTER;console.log("onResumeAfter",this.$className);this.trigger("resumeAfter",this,null);var t=this.getCurrentPage();t.onResumeAfter()},onPauseBefore:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_PAUSE_BEFORE;console.log("onPauseBefore",this.$className);this.trigger("pauseBefore",this,null);var t=this.getCurrentPage();t.onPauseBefore()},onPauseAfter:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_PAUSE_AFTER;console.log("onPauseAfter",this.$className);this.trigger("pauseAfter",this,null);var t=this.getCurrentPage();t.onPauseAfter()},onDestroy:function(){this._lifeCycleState=this.LIFE_CYCLE_STATE_DESTROY;console.log("onDestroy",this.$className);this.trigger("destroy",this,null);var t=this.getCurrentPage();t.onDestroy()},_createPage:function(t,e){var i=Navy.Config.page[t];Navy.Resource.loadScript(i.classFile,this._onLoadScript.bind(this,i,e))},_createPageByLayout:function(t,e){var i=Navy.Resource.getClass(t.class);var n=new i(t,e);this.addView(n,this._sceneFixedFirstView)},_onLoadScript:function(t,e){var i=Navy.Resource.getClass(t.class);var n=new i(t,e);this.addView(n,this._sceneFixedFirstView)},_addPage:function(t){this._lifeCycleState>=this.LIFE_CYCLE_STATE_CREATE&&t.onCreate();this._lifeCycleState>=this.LIFE_CYCLE_STATE_RESUME_BEFORE&&t.onResumeBefore();var e=this._getCurrentStack();if(e){var i=e.page;i.onPauseBefore()}var n=Navy.Resource.getClass(t.getLayout().extra.transition.class);var a=new n(i,t);this._pageStack.push({page:t,transition:a});a.start(this._onTransitionStartEnd.bind(this))},_getCurrentStack:function(){if(this._pageStack.length>=1){return this._pageStack[this._pageStack.length-1]}else{return null}},_getPrevStack:function(){if(this._pageStack.length>=2){return this._pageStack[this._pageStack.length-2]}else{return null}},_onTransitionStartEnd:function(){var t=this._getPrevStack();if(t){t.page.onPauseAfter()}var e=this._getCurrentStack();if(e){this._lifeCycleState>=this.LIFE_CYCLE_STATE_RESUME_AFTER&&e.page.onResumeAfter()}Navy.Root.unlockView()},_onTransitionBackEnd:function(){var t=this._getPrevStack();if(t){t.page.onResumeAfter()
}var e=this._getCurrentStack();if(e){e.page.onPauseAfter();e.page.onDestroy();var i=this._pageStack.pop();i.page.destroy()}Navy.Root.unlockView()}});Navy.Class("Navy.Transition.Transition",{initialize:function(t,e){},start:function(t){},back:function(t){}});Navy.Class("Navy.Transition.Fade",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}t&&t._setRawStyle({webkitAnimation:"0.5s"});e&&e._setRawStyle({webkitAnimation:"0.5s",opacity:0})},_addAnimationStyle:function(){var t="@-webkit-keyframes fade_in  {100% {opacity: 1}}";var e="@-webkit-keyframes fade_out {100% {opacity: 0}}";var i=document.createElement("style");i.textContent=t+e;document.head.appendChild(i)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({opacity:""});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._beforeView._setRawStyle({webkitAnimationName:""});this._beforeView.removeRawEventListener("webkitAnimationEnd",e);this._afterView.addRawEventListener("webkitAnimationEnd",i);this._afterView._setRawStyle({opacity:0,webkitAnimationName:"fade_in"})}.bind(this);var i=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",i);this._afterView._setRawStyle({opacity:"",webkitAnimationName:"none"});t&&t()}.bind(this);this._beforeView.addRawEventListener("webkitAnimationEnd",e);this._beforeView._setRawStyle({webkitAnimationName:"fade_out"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"none"});this._beforeView.addRawEventListener("webkitAnimationEnd",i);this._beforeView._setRawStyle({opacity:0,webkitAnimationName:"fade_in"});this._beforeView.setVisible(true)}.bind(this);var i=function(){this._beforeView.removeRawEventListener("webkitAnimationEnd",i);this._beforeView._setRawStyle({opacity:"",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"fade_out"})}});Navy.Class("Navy.Transition.PopUp",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}e&&e._setRawStyle({webkitAnimation:"0.5s",webkitTransform:"scale(0)"})},_addAnimationStyle:function(){var t="@-webkit-keyframes pop_up_in  {100% {-webkit-transform: scale(1)}}";var e="@-webkit-keyframes pop_up_out {100% {-webkit-transform: scale(0)}}";var i=document.createElement("style");i.textContent=t+e;document.head.appendChild(i)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:""});t&&t();return}var e=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"pop_up_in"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.setVisible(false);this._beforeView.setVisible(true);t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"pop_up_out"})}});Navy.Class("Navy.Transition.SlideDown",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}var i=Navy.Config.app.size.height;e._setRawStyle({webkitAnimation:"0.5s",webkitTransform:"translateY(-"+i+"px)"})},_addAnimationStyle:function(){var t=Navy.Config.app.size.height;var e="@-webkit-keyframes slide_up_in  {100% {-webkit-transform: translateY(0)}}";var i="@-webkit-keyframes slide_up_out {100% {-webkit-transform: translateY(-%height%px)}}".replace("%height%",t);var n=document.createElement("style");n.textContent=e+i;document.head.appendChild(n)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:"none"});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_up_in"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",e);t&&t()}.bind(this);this._beforeView.setVisible(true);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_up_out"})}});Navy.Class("Navy.Transition.SlideLeft",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}var i=Navy.Config.app.size.width;e._setRawStyle({webkitAnimation:"0.5s",webkitTransform:"translateX(-"+i+"px)"})},_addAnimationStyle:function(){var t=Navy.Config.app.size.width;var e="@-webkit-keyframes slide_left_in  {100% {-webkit-transform: translateX(0)}}";var i="@-webkit-keyframes slide_left_out {100% {-webkit-transform: translateX(-%width%px)}}".replace("%width%",t);var n=document.createElement("style");n.textContent=e+i;document.head.appendChild(n)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:"none"});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_left_in"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",e);t&&t()}.bind(this);this._beforeView.setVisible(true);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_left_out"})}});Navy.Class("Navy.Transition.SlideRight",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}var i=Navy.Config.app.size.width;e._setRawStyle({webkitAnimation:"0.5s",webkitTransform:"translateX("+i+"px)"})},_addAnimationStyle:function(){var t=Navy.Config.app.size.width;var e="@-webkit-keyframes slide_right_in  {100% {-webkit-transform: translateX(0)}}";var i="@-webkit-keyframes slide_right_out {100% {-webkit-transform: translateX(%width%px)}}".replace("%width%",t);var n=document.createElement("style");n.textContent=e+i;document.head.appendChild(n)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:"none"});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_right_in"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",e);t&&t()}.bind(this);this._beforeView.setVisible(true);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_right_out"})}});Navy.Class("Navy.Transition.SlideUp",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}var i=Navy.Config.app.size.height;e._setRawStyle({webkitAnimation:"0.5s",webkitTransform:"translateY("+i+"px)"})},_addAnimationStyle:function(){var t=Navy.Config.app.size.height;var e="@-webkit-keyframes slide_up_in  {100% {-webkit-transform: translateY(0)}}";var i="@-webkit-keyframes slide_up_out {100% {-webkit-transform: translateY(%height%px)}}".replace("%height%",t);var n=document.createElement("style");n.textContent=e+i;document.head.appendChild(n)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:"none"});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_up_in"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",e);t&&t()}.bind(this);this._beforeView.setVisible(true);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimationName:"slide_up_out"})}});Navy.Class("Navy.Transition.TurnOver",Navy.Transition.Transition,{$static:{initAnimationStyle:false},_beforeView:null,_afterView:null,initialize:function(t,e){this._beforeView=t;this._afterView=e;if(!this.$class.initAnimationStyle){this._addAnimationStyle();this.$class.initAnimationStyle=true}t._setRawStyle({webkitAnimation:"0.25s",webkitAnimationTimingFunction:"linear",webkitTransform:"rotateY(0)"});e._setRawStyle({webkitAnimation:"0.25s",webkitAnimationTimingFunction:"linear",webkitTransform:"rotateY(-90deg)"})},_addAnimationStyle:function(){var t="      @-webkit-keyframes turn_over_in_before_view {100% {-webkit-transform: rotateY(90deg)} }      @-webkit-keyframes turn_over_in_after_view {100% {-webkit-transform: rotateY(0)} }";var e="      @-webkit-keyframes turn_over_out_before_view {100% {-webkit-transform: rotateY(0)} }      @-webkit-keyframes turn_over_out_after_view {100% {-webkit-transform: rotateY(-90deg)} }";var i=document.createElement("style");i.textContent=t+e;document.head.appendChild(i)},start:function(t){if(!this._beforeView){this._afterView._setRawStyle({webkitTransform:"none"});t&&t();return}var e=function(){this._beforeView.setVisible(false);this._beforeView.removeRawEventListener("webkitAnimationEnd",e);this._beforeView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});this._afterView.setVisible(true);this._afterView.addRawEventListener("webkitAnimationEnd",i);this._afterView._setRawStyle({webkitAnimationName:"turn_over_in_after_view"})}.bind(this);var i=function(){this._afterView.removeRawEventListener("webkitAnimationEnd",i);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.setVisible(false);this._beforeView.addRawEventListener("webkitAnimationEnd",e);this._beforeView._setRawStyle({webkitAnimationName:"turn_over_in_before_view"})},back:function(t){if(!this._beforeView){t&&t();return}var e=function(){this._afterView.setVisible(false);this._afterView.removeRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});this._beforeView._setRawStyle({webkitAnimation:"0.25s",webkitAnimationTimingFunction:"linear",webkitTransform:"rotateY(90deg)"});this._beforeView.setVisible(true);this._beforeView.addRawEventListener("webkitAnimationEnd",i);this._beforeView._setRawStyle({webkitAnimationName:"turn_over_out_before_view"})}.bind(this);var i=function(){this._beforeView.removeRawEventListener("webkitAnimationEnd",i);this._beforeView._setRawStyle({webkitTransform:"none",webkitAnimationName:"none"});t&&t()}.bind(this);this._afterView.addRawEventListener("webkitAnimationEnd",e);this._afterView._setRawStyle({webkitAnimation:"0.25s",webkitAnimationTimingFunction:"linear",webkitTransform:"rotateY(0)"});this._afterView._setRawStyle({webkitAnimationName:"turn_over_out_after_view"})}});Navy.Class("Navy.Gesture.Gesture",{isStart:false,initialize:function(t,e){this._element=t;this._callback=e},start:function(){},stop:function(){}});Navy.Class("Navy.Gesture.Tap",Navy.Gesture.Gesture,{TAP_ALLOW_DISTANCE:350,_trigger:false,_startX:null,_startY:null,initialize:function($super,t,e){$super(t,e);this._touchstart=this._touchstart.bind(this);this._touchmove=this._touchmove.bind(this);this._touchend=this._touchend.bind(this)},start:function($super){$super();this._element.addEventListener("touchstart",this._touchstart)},stop:function($super){$super();this._element.removeEventListener("touchstart",this._touchstart)},_touchstart:function(t){if(t.touches.length>1){return}this._trigger=true;this._startX=t.changedTouches[0].clientX;this._startY=t.changedTouches[0].clientY;this._element.addEventListener("touchmove",this._touchmove);this._element.addEventListener("touchend",this._touchend)},_touchmove:function(t){this._judgeTapAllowDistance(t)},_touchend:function(t){this._element.removeEventListener("touchmove",this._touchmove);this._element.removeEventListener("touchend",this._touchend);this._judgeTapAllowDistance(t);this._trigger&&this._callback(t)},_judgeTapAllowDistance:function(t){var e=this._startX;var i=this._startY;var n=t.changedTouches[0].clientX;var a=t.changedTouches[0].clientY;var s=Math.pow(Math.abs(e-n),2)+Math.pow(Math.abs(i-a),2);if(s>=this.TAP_ALLOW_DISTANCE){this._trigger=false}}})})();